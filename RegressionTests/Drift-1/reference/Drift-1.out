OPAL-X> configure done argc= 4
OPAL-X>               ____  _____        _       __   __
OPAL-X> 
OPAL-X> This is OPAL-X (Object Oriented Parallel Accelerator Library) Version 1.0
OPAL-X>             git rev. 08a2c33a137eb49769954b5723efecdd6e6a00d0
OPAL-X> 
OPAL-X> 
OPAL-X>                      (c) PSI, http://amas.web.psi.ch
OPAL-X> 
OPAL-X> 
OPAL-X> This is the performance portable version of OPAL
OPAL-X> 
OPAL-X> Please send cookies, goodies or other motivations (wine and beer ... ) 
OPAL-X> to the OPAL developers 
OPAL-X> 
OPAL-X> Time: 17:02:56 date: 28/02/2026
OPAL-X> 
OPAL-X> * Host:   OpenMP
OPAL-X> * Device: OpenMP
OPAL-X> 
OPAL-X> * Reading input stream 'Drift-1.in'
OPAL-X> 
OPAL-X> value: {OPALVERSION} = {10000}
OPAL-X> 
OPAL-X> 
OPAL-X> value: {EDES,P0} = {0.01, 0.0104986}
OPAL-X> 
OPAL-X> * Number of distributions  1
OPAL-X> 
OPAL-X> * ************* D I S T R I B U T I O N ********************************************
OPAL-X> * 
OPAL-X> * Distribution type: GAUSS
OPAL-X> * 
OPAL-X> * SIGMAX     = 0.001 [m]
OPAL-X> * SIGMAY     = 0.005 [m]
OPAL-X> * SIGMAZ     = 0.01 [m]
OPAL-X> * SIGMAPX    = 1e-06 [Beta Gamma]
OPAL-X> * SIGMAPY    = 1e-06 [Beta Gamma]
OPAL-X> * SIGMAPZ    = 1e-06 [Beta Gamma]
OPAL-X> * 
OPAL-X> * Distribution is injected.
OPAL-X> * 
OPAL-X> * **********************************************************************************
OPAL-X> 
OPAL-X> * ************* F I E L D S O L V E R ********************************************** 
OPAL-X> * FIELDSOLVER  FS1
OPAL-X> * TYPE         NONE
OPAL-X> * RANKS       1
OPAL-X> * NX           32
OPAL-X> * NY           32
OPAL-X> * NZ           32
OPAL-X> * BBOXINCR     5
OPAL-X> * GREENSF      STANDARD
OPAL-X> * XDIM         parallel  
OPAL-X> * YDIM         parallel  
OPAL-X> * ZDIM      serial  
OPAL-X> * ********************************************************************************** 
OPAL-X> 
OPAL-X> * ************* B E A M ************************************************************ 
OPAL-X> * BEAM        BEAM1
OPAL-X> * PARTICLE    ELECTRON
OPAL-X> * REST MASS   0.000510999 [GeV]
OPAL-X> * CHARGE      -e * 1 
OPAL-X> * MOMENTUM    1.04986e+07 [eV/c]
OPAL-X> * MOMENTUM    0.0104986 [GeV/c]
OPAL-X> * CURRENT     1.3 [A]
OPAL-X> * FREQUENCY   1.3e+09 [MHz]
OPAL-X> * NPART       100000
OPAL-X> * ********************************************************************************** 
OPAL-X> 
OPAL-X> * Macro charge per particle [eV]: -1e-20
OPAL-X> * Macro mass per particle: [GeV/c^2] 3.1894e-05
OPAL-X> * Particles per macro particle: 0.0624151
OPAL-X> PartBunch Constructor
OPAL-X> * FieldContainer set to isAllPeriodic = 0
AdaptBins> AdaptBins initialized with maxBins = 128, alpha = 1, beta = 1.5, desiredWidth = 0.1
KOKKOS DEBUG> =====================================
KOKKOS DEBUG>  Kokkos Debug Information (Rank 0)
KOKKOS DEBUG> =====================================
KOKKOS DEBUG> CPU Threads (OpenMP): 1
KOKKOS DEBUG> CUDA: GPU support disabled.
KOKKOS DEBUG> Default Execution Space Concurrency: 1
KOKKOS DEBUG> Binning cost function parameters: alpha = 1, beta = 1.5, desiredWidth = 0.1
KOKKOS DEBUG> =====================================
PartBunch::setSolver> Initializing solver: NONE
FieldContainer::initializeFields> Mesh spacing = ( 0.1875 , 0.1875 , 0.1875 )
FieldContainer::initializeFields> Origin       = ( -3 , -3 , -3 )
FieldContainer::initializeFields> FL           = Domain = {[0:31:1],[0:31:1],[0:31:1]}
FieldContainer::initializeFields> Total number of boxes = 1
FieldContainer::initializeFields>     Box 0 {[0:31:1],[0:31:1],[0:31:1]}
FieldContainer::initializeFields> 
FieldContainer::initializeFields> E_m, rho_m field initialized.
FieldSolver::setPotentialBCs> Potential BCs only need to be set for CG solver. Current solver type: NONE
PartBunch::setSolver> Field solver set.
FieldSolver::initSolverWithParams> Initialized solver with params: NONE
FieldSolver::initSolverWithParams> Set solver RHS.
FieldSolver::initSolverWithParams> Set solver LHS.
PartBunch::setSolver> Field solver initialized.
PartBunch::setSolver> Solver and Load Balancer set.
PartBunch::pre_run> PartBunch pre_run started.
PartBunch::pre_run> Rho initialized to zero.
FieldSolver::runSolver> Running solver with type: NONE. Force skip field dump: 1
PartBunch::pre_run> Field solver ran during pre_run.
PartBunch::pre_run> Call counter reset. pre_run done.
OPAL-X> * PartBunch constructor done.
OPAL-X> not implemented
OPAL-X> * BCHandler<3>: [OPEN, OPEN, OPEN]
OPAL-X> number_of_processors 14
OPAL-X> MPI_Comm_size 1
OPAL-X> * About to create particles ...
OPAL-X> * Particle creation done
PartBunch::bunchUpdate> Updating bunch and doing repartitioning if needed.
PartBunch::bunchUpdate> Field Container updated with new mesh boundaries and spacing:
PartBunch::bunchUpdate> 		> Mesh origin:   ( -0.00329404 , -0.0164645 , -0.0329878 )
PartBunch::bunchUpdate> 		> Mesh spacing:  ( 0.000206071 , 0.00103007 , 0.00206111 )
PartBunch::bunchUpdate> 		> Box increment: 5%
PartBunch::bunchUpdate> Particle container updated with new layout.
PartBunch::bunchUpdate> Load balancer repartitioning done.
PartBunch::bunchUpdate> Moments updated.
OPAL-X> 
OPAL-X> * ************** B U N C H ********************************************************* 
OPAL-X> * PARTICLES       = 100000
OPAL-X> * CHARGE          = -1.000000e-15 (Cb) 
OPAL-X> * INTEGRATOR      = LF2
OPAL-X> * MIN R (origin)  = (     -2.99430 ,    -14.96617 ,    -29.98979 ) [mm]
OPAL-X> * MAX R (max ext) = (      3.00048 ,     14.99957 ,     29.96972 ) [mm]
OPAL-X> * RMS R           = (      0.98867 ,      4.95020 ,      9.86188 ) [mm]
OPAL-X> * RMS P           = ( 1.004750e-06 , 9.949962e-07 , 9.982187e-07 ) [beta gamma]
OPAL-X> * Mean R: ( 1.695475e-20 , 4.201674e-19 , -4.040431e-19 ) [m]
OPAL-X> * Mean P: ( -9.378422e-10 , -1.362059e-09 , 2.054519e+01 ) [beta gamma]
OPAL-X> * MESH SPACING    = (      0.20607 ,      1.03007 ,      2.06111 ) [mm]
OPAL-X> * COMPDOM INCR    = 5.000000e+00 (%) 
OPAL-X> * FIELD LAYOUT    = Domain = {[0:31:1],[0:31:1],[0:31:1]}
OPAL-X> Total number of boxes = 1
OPAL-X>     Box 0 {[0:31:1],[0:31:1],[0:31:1]}
OPAL-X> 
OPAL-X> * Centroid : 
OPAL-X> * 1.695475e-15 -9.378422e-05 4.201674e-14 -1.362059e-04 -4.040431e-14 2.054519e+06 
OPAL-X> * Cov Matrix : 
OPAL-X> * 9.774728e-07 -1.796674e-12 -2.184526e-10 2.516900e-12 -8.284270e-08 -6.670684e-12 
OPAL-X> * -1.796674e-12 1.009522e-12 -1.725733e-11 -6.088719e-16 -5.258092e-11 3.483443e-15 
OPAL-X> * -2.184526e-10 -1.725733e-11 2.450452e-05 4.067032e-12 -3.937397e-08 -1.998788e-11 
OPAL-X> * 2.516900e-12 -6.088719e-16 4.067032e-12 9.900173e-13 2.678484e-11 -4.076246e-15 
OPAL-X> * -8.284270e-08 -5.258092e-11 -3.937397e-08 2.678484e-11 9.725676e-05 -4.194559e-11 
OPAL-X> * -6.670684e-12 3.483443e-15 -1.998788e-11 -4.076246e-15 -4.194559e-11 9.964406e-13 
OPAL-X> * * ********************************************************************************** 
OPAL-X> * Creating new file for data: 'Drift-1.stat'
OPAL-X> * Creating new file for data: 'Drift-1.lbal'
ParallelTracker::execute> Initialized Boris pusher.
ParallelTracker::execute> Selected minimum time step from configuration: 5e-11
OPAL-X> * D1 gone live
ParallelTracker::execute> Activated all beamline elements.
ParallelTracker::execute> Transformed reference particle position and momentum to lab frame.
ParallelTracker::execute> Initial bunch bounds:
ParallelTracker::execute>   rmin = ( -3 , -3 , -3 )
ParallelTracker::execute>   rmax = ( 3 , 3 , 3 )
ParallelTracker::execute> ParallelTrack: momentum = 20.5452
ParallelTracker::execute> itsBunch_m->RefPartR_m = ( 0 , 0 , 0 )
ParallelTracker::execute> itsBunch_m->RefPartP_m = ( -9.37842e-10 , -1.36206e-09 , 20.5452 )
OPAL-X> OrbitThreader dt_m= 5e-11
OPAL-X> OrbitThreader maxDistance= 1.14972
OPAL-X> OrbitThreader #elements  = 1
OPAL-X> 
OPAL-X> * Size of map 1 sections 
OPAL-X> * Key: (0.000000 - 1.003117) number of overlapping elements 1
OPAL-X> *                            D1
OPAL-X> 
OPAL-X> * Creating new file for data: 'data/Drift-1_ElementPositions.sdds'
ParallelTracker::execute> Orbit threader execution done.
ParallelTracker::execute> Set time view of particle bunch.
ParallelTracker::execute> Reset bunch time to 0.
ParallelTracker::execute> * Track start at: 17:02:56, t= 0.000 [fs]; zstart at: 0.000 [um]
ParallelTracker::execute> * Executing ParallelTracker
ParallelTracker::execute> * Initial dt = 50.000 [ps]
ParallelTracker::execute> * Max integration steps = 1, next step = 0
ParallelTracker::execute> 
OPAL-X>                dt [ns]           zStop [m]        num Steps [1]
OPAL-X> ->         5.000000e-11        1.000000e+00                   1
PartBunch::performBunchSanityChecks> ========== Performing sanity checks on PartBunch... ==========
PartBunch::performBunchSanityChecks> BC Handler initialized properly.
PartBunch::performBunchSanityChecks> Field Solver object was initialized.
PartBunch::performBunchSanityChecks> FieldSolver internal field pointers are set.
PartBunch::performBunchSanityChecks> FieldSolver fields match FieldContainer.
PartBunch::performBunchSanityChecks> FieldSolver type: NONE
PartBunch::performBunchSanityChecks> E-field layout initialized.
PartBunch::performBunchSanityChecks> ========= Done performing PartBunch sanity checks... =========
ParallelTracker::execute> >>>>>>>>>>>>>>>>>> Starting Tracking Loop >>>>>>>>>>>>>>>>>>
ParallelTracker::execute> Starting track with dt = 50.000 [ps], track steps = 0 to 1.
PartBunch::calcBeamParameters> Moments updated.
PartBunch::calcBeamParameters> Local moments calculated.
PartBunch::calcBeamParameters> Global moments calculated.
PartBunch::calcBeamParameters> Local min/max calculated.
PartBunch::calcBeamParameters> Global min/max calculated.
OPAL-X> * Switched to unitless positions.
OPAL-X> * Switched to physical positions.
PartBunch::bunchUpdate> Updating bunch and doing repartitioning if needed.
PartBunch::bunchUpdate> Field Container updated with new mesh boundaries and spacing:
PartBunch::bunchUpdate> 		> Mesh origin:   ( -0.00329404 , -0.0164645 , -0.0255018 )
PartBunch::bunchUpdate> 		> Mesh spacing:  ( 0.000206071 , 0.00103007 , 0.00206111 )
PartBunch::bunchUpdate> 		> Box increment: 5%
PartBunch::bunchUpdate> Particle container updated with new layout.
PartBunch::bunchUpdate> Load balancer repartitioning done.
PartBunch::bunchUpdate> Moments updated.
ParallelTracker::timeIntegration1> Push particles done.
ParallelTracker::execute> timeIntegration1 done at step 0.
ParallelTracker::execute> E and B fields reset at step 0.
PartBunch::calcBeamParameters> Moments updated.
PartBunch::calcBeamParameters> Local moments calculated.
PartBunch::calcBeamParameters> Global moments calculated.
PartBunch::calcBeamParameters> Local min/max calculated.
PartBunch::calcBeamParameters> Global min/max calculated.
ParallelTracker::computeSpaceChargeFields> Calculate beam parameters done.
ParallelTracker::computeSpaceChargeFields> Transform particle positions to beam coordinate system done.
AdaptBins> Initialized limits. Min: 0.998818, max: 0.998818, binWidth: 8.54264e-12
AdaptBins> All bins assigned.
AdaptBins> Using host-only parallel_reduce reduction.
AdaptBins> Reducer ran without error.
AdaptBins> Global histogram created.
Histogram> Re-binned from 128 bins down to 1 bins. Total deviation cost = 0.015
AdaptBins> Using host-only parallel_reduce reduction.
AdaptBins> Reducer ran without error.
PartBunch::computeSelfFields> Binning routine done.
PartBunch::bunchUpdate> Updating bunch and doing repartitioning if needed.
PartBunch::bunchUpdate> Field Container updated with new mesh boundaries and spacing:
PartBunch::bunchUpdate> 		> Mesh origin:   ( -0.00329404 , -0.0164645 , -0.0255018 )
PartBunch::bunchUpdate> 		> Mesh spacing:  ( 0.000206071 , 0.00103007 , 0.00206111 )
PartBunch::bunchUpdate> 		> Box increment: 5%
PartBunch::bunchUpdate> Particle container updated with new layout.
PartBunch::bunchUpdate> Load balancer repartitioning done.
PartBunch::bunchUpdate> Moments updated.
PartBunch::computeSelfFields> Scatter done.
PartBunch::computeSelfFields> Rho scale by dt done.
PartBunch::computeSelfFields> Rho normalized by cell volume: 4.37507e-10.
PartBunch::computeSelfFields> Net-0 charge generation with factor -9.28418e-11 done.
PartBunch::computeSelfFields> Rho coupling applied.
FieldSolver::runSolver> Running solver with type: NONE. Force skip field dump: 0
PartBunch::computeSelfFields> Field solver run.
PartBunch::computeSelfFields> Gather done.
ParallelTracker::computeSpaceChargeFields> Compute self fields done.
ParallelTracker::computeSpaceChargeFields> Transform particle positions back to reference coordinate system done.
ParallelTracker::computeSpaceChargeFields> Rotate E fields back to reference coordinate system done.
ParallelTracker::computeSpaceChargeFields> Rotate B fields back to reference coordinate system done. ComputeSelfFields done.
ParallelTracker::execute> Space charge field computation done at step 0.
ParallelTracker::execute> External field computation done at step 0.
ParallelTracker::kickParticles> Got particle views for kick operation.
ParallelTracker::kickParticles> Completed parallel kick operation.
ParallelTracker::timeIntegration2> Kick particles done.
OPAL-X> * Switched to unitless positions.
OPAL-X> * Switched to physical positions.
PartBunch::bunchUpdate> Updating bunch and doing repartitioning if needed.
PartBunch::bunchUpdate> Field Container updated with new mesh boundaries and spacing:
PartBunch::bunchUpdate> 		> Mesh origin:   ( -0.00329404 , -0.0164645 , -0.0180159 )
PartBunch::bunchUpdate> 		> Mesh spacing:  ( 0.000206071 , 0.00103007 , 0.00206111 )
PartBunch::bunchUpdate> 		> Box increment: 5%
PartBunch::bunchUpdate> Particle container updated with new layout.
PartBunch::bunchUpdate> Load balancer repartitioning done.
PartBunch::bunchUpdate> Moments updated.
ParallelTracker::timeIntegration2> Push particles done.
ParallelTracker::execute> timeIntegration2 done at step 0.
ParallelTracker::execute> Set time view of particle bunch to dt = 50.000 [ps].
ParallelTracker::execute> Selected new time step for next iteration, back_track = 0.
ParallelTracker::execute> Incremented bunch time to 50.000 [ps].
ParallelTracker::execute> Updated reference particle at step 0.
ParallelTracker::execute> Updated path length to 0.0149719.
OPAL-X> * 17:02:56 Step      0 at 14.972 [mm], t= 50.000 [ps], E=624.151 [keV]
PartBunch::calcBeamParameters> Moments updated.
PartBunch::calcBeamParameters> Local moments calculated.
PartBunch::calcBeamParameters> Global moments calculated.
PartBunch::calcBeamParameters> Local min/max calculated.
PartBunch::calcBeamParameters> Global min/max calculated.
OPAL-X> * Wrote beam statistics.
ParallelTracker::execute> Track steps incremented.
ParallelTracker::execute> Calculated drift per time step: 14.972 [mm].
PartBunch::calcBeamParameters> Moments updated.
PartBunch::calcBeamParameters> Local moments calculated.
PartBunch::calcBeamParameters> Global moments calculated.
PartBunch::calcBeamParameters> Local min/max calculated.
PartBunch::calcBeamParameters> Global min/max calculated.
OPAL-X> not implemented
OPAL-X> not implemented
OPAL-X> * Dump phase space of last step
OPAL-X> * D1 gone off
OPAL-X> 
OPAL-X> * Done executing ParallelTracker at 17:02:56
OPAL-X> 
OPAL-X> * PartBunch Destructor: Finished time step: 0 time: 0.000000e+00
OPAL-X> * End of input stream 'Drift-1.in'
Timings> ---------------------------------------------
Timings>      Timing results for 1 nodes:
Timings> ---------------------------------------------
Timings> mainTimer........... Wall tot =   0.115025
Timings> 
Timings> gatherInfoPartBunch. Wall max = 6.2313e-05
Timings>                      Wall avg = 6.2313e-05
Timings>                      Wall min = 6.2313e-05
Timings> 
Timings> bInitLimits......... Wall max = 0.000229801
Timings>                      Wall avg = 0.000229801
Timings>                      Wall min = 0.000229801
Timings> 
Timings> bAllReduceLimits.... Wall max =   4.21e-07
Timings>                      Wall avg =   4.21e-07
Timings>                      Wall min =   4.21e-07
Timings> 
Timings> bAllReduceGlobalHis. Wall max =   3.68e-07
Timings>                      Wall avg =   3.68e-07
Timings>                      Wall min =   3.68e-07
Timings> 
Timings> bAssignUniformBins.. Wall max = 0.000285903
Timings>                      Wall avg = 0.000285903
Timings>                      Wall min = 0.000285903
Timings> 
Timings> bExecuteHistoReduct. Wall max = 0.000193132
Timings>                      Wall avg = 0.000193132
Timings>                      Wall min = 0.000193132
Timings> 
Timings> bSortContainerByBin. Wall max = 0.000601771
Timings>                      Wall avg = 0.000601771
Timings>                      Wall min = 0.000601771
Timings> 
Timings> bVerifySorting...... Wall max =          0
Timings>                      Wall avg =          0
Timings>                      Wall min =          0
Timings> 
Timings> setSolver........... Wall max = 0.000412393
Timings>                      Wall avg = 0.000412393
Timings>                      Wall min = 0.000412393
Timings> 
Timings> prerun.............. Wall max = 4.1763e-05
Timings>                      Wall avg = 4.1763e-05
Timings>                      Wall min = 4.1763e-05
Timings> 
Timings> samplingTime........ Wall max =  0.0427719
Timings>                      Wall avg =  0.0427719
Timings>                      Wall min =  0.0427719
Timings> 
Timings> SamplingTimer....... Wall max =  0.0427585
Timings>                      Wall avg =  0.0427585
Timings>                      Wall min =  0.0427585
Timings> 
Timings> GenParticles........ Wall max =  0.0427592
Timings>                      Wall avg =  0.0427592
Timings>                      Wall min =  0.0427592
Timings> 
Timings> particleBC.......... Wall max = 0.000686189
Timings>                      Wall avg = 0.000686189
Timings>                      Wall min = 0.000686189
Timings> 
Timings> updateParticle...... Wall max =          0
Timings>                      Wall avg =          0
Timings>                      Wall min =          0
Timings> 
Timings> Write Stat.......... Wall max = 0.000105933
Timings>                      Wall avg = 0.000105933
Timings>                      Wall min = 0.000105933
Timings> 
Timings> Write H5-File....... Wall max =  0.0109826
Timings>                      Wall avg =  0.0109826
Timings>                      Wall min =  0.0109826
Timings> 
Timings> TIntegration1....... Wall max = 0.00452953
Timings>                      Wall avg = 0.00452953
Timings>                      Wall min = 0.00452953
Timings> 
Timings> TIntegration2....... Wall max = 0.00545729
Timings>                      Wall avg = 0.00545729
Timings>                      Wall min = 0.00545729
Timings> 
Timings> External field eval. Wall max = 0.000905158
Timings>                      Wall avg = 0.000905158
Timings>                      Wall min = 0.000905158
Timings> 
Timings> Binaryrepart........ Wall max =          0
Timings>                      Wall avg =          0
Timings>                      Wall min =          0
Timings> 
Timings> OrbThreader......... Wall max = 0.000488437
Timings>                      Wall avg = 0.000488437
Timings>                      Wall min = 0.000488437
Timings> 
Timings> bTotalBinningT...... Wall max = 0.00154471
Timings>                      Wall avg = 0.00154471
Timings>                      Wall min = 0.00154471
Timings> 
Timings> bDeviceSyncronizati. Wall max =   5.51e-07
Timings>                      Wall avg =   5.51e-07
Timings>                      Wall min =   5.51e-07
Timings> 
Timings> bHistogramInit...... Wall max = 1.0832e-05
Timings>                      Wall avg = 1.0832e-05
Timings>                      Wall min = 1.0832e-05
Timings> 
Timings> bMergeBins.......... Wall max = 6.2764e-05
Timings>                      Wall avg = 6.2764e-05
Timings>                      Wall min = 6.2764e-05
Timings> 
Timings> SolveTimer.......... Wall max =  0.0133733
Timings>                      Wall avg =  0.0133733
Timings>                      Wall min =  0.0133733
Timings> 
Timings> scatter............. Wall max = 0.00600902
Timings>                      Wall avg = 0.00600902
Timings>                      Wall min = 0.00600902
Timings> 
Timings> accumulateHalo...... Wall max =   1.58e-07
Timings>                      Wall avg =   1.58e-07
Timings>                      Wall min =   1.58e-07
Timings> 
Timings> fillHalo............ Wall max =    8.7e-08
Timings>                      Wall avg =    8.7e-08
Timings>                      Wall min =    8.7e-08
Timings> 
Timings> gather.............. Wall max = 0.00318933
Timings>                      Wall avg = 0.00318933
Timings>                      Wall min = 0.00318933
Timings> 
Timings> ---------------------------------------------
